# File to Media Migration configuration for Article Media migration

id: person_media_step1
label: Person Media Step 1 (migrate_file_to_media)
migration_group: az_migration

source:
    key: migrate
    # Adapt it to your language
    langcode: und
    plugin: media_entity_generator_d7
    entity_type: node
    bundle: uaqs_person
    d7_file_url: 'https://dev-shantzios-d7.pantheonsite.io/sites/default/files/'
    field_names:
        - field_uaqs_photo

destination:
    plugin: entity:media

process:
    bundle:
        plugin: default_value
        default_value: az_image

    # Using the alt tag if available, else the file name.
    name:
        plugin: media_name
        source: file_name

    # This process plugin will skip the whole row if a existing media is found.
    existing_media_file:
        plugin: check_media_duplicate
        source: target_id

    # This process plugin will skip the whole row if a duplicate image is found.
    unique_file_id:
        plugin: check_duplicate
        source: target_id

    # Map the field image
    field_media_az_image/alt: alt
    field_media_az_image/title: title
    field_media_az_image/target_id:
        plugin: media_file_copy
        move: FALSE
        reuse: TRUE
        path: 'public://media/person/'
        source: file_path

    langcode: langcode

    uid:
        plugin: default_value
        default_value: 1
